<!DOCTYPE html>
<html lang="pt-br">

<head>
    <title>Algoritmo de Fortune para Diagrama de Voronoi</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400;1,700&family=Open+Sans+Condensed:ital,wght@0,300;1,300&family=Open+Sans:ital,wght@0,300;0,400;0,700;0,800;1,300;1,400;1,700;1,800&family=Oxygen+Mono&family=Josefin+Sans:ital,wght@0,200;0,600;1,200;1,600&display=swap">
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/highlight.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/color.css">
    <!--<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>-->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
    <script src="assets/js/highlight.js"></script>
    <script src="assets/js/script.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <a href="">abrir tudo</a>
            <a href="">fechar tudo</a>
        </header>
        <main>

            <h1>Algoritmo de Fortune para Diagrama de Voronoi</h1>
<h2>Como se encontrar pela floresta</h2>
<h2>Motivação</h2>
<p>Imagine que você é um pássaro!
Você está voando o dia todo e não conseguiu beber nenhum gole de água. Por sorte, você sabe que ao seu redor, num raio de poucos quilômetros, existem algumas fontes de água. Aqui está o mapa da floresta:</p>
<figure class="img"><img src="img/mapa1.jpg" alt="Mapa da floresta"></figure>
<p>Cada caixinha azul é um ponto de água diferente.</p>
<blockquote class="warning">
<p>Aviso</p>
<p>Como sabemos qual ponto de água mais próximo de você?</p>
</blockquote>
<h2>Métodos de localização:</h2>
<h2>Método das distâncias</h2>
<p>Você sabe sua posição e a posição das fontes de água ao seu redor pois você é um pássaro e seu senso de localização é ótimo! (quase um GPS biológico).</p>
<figure class="img"><img src="img/mapa2.jpg" alt="Mapa da florestacom coordenadas"></figure>
<p>É possível calcular todas as distâncias entre os você e cada um dos pontos utilizando o teorema de pitágoras.</p>
<blockquote class="question">
<p>Pergunta</p>
<p>Tente encontrar o menor valor entre eles:</p>
<details class="answer">
<summary>Resposta</summary>
<p>O arquivo <code class="language-md">dist_m1.py</code> calcula todas essas distâncias e imprime seus valores.</p>
<figure class="table"><table>
<thead>
<tr>
<th>Lugar</th>
<th>Distância</th>
</tr>
</thead>
<tbody>
<tr>
<td>Queda d’água</td>
<td>1.12 km</td>
</tr>
<tr>
<td>Riacho</td>
<td>2.92 km</td>
</tr>
<tr>
<td>Pedra do sapo</td>
<td>1.80 km</td>
</tr>
<tr>
<td>Córrego azul</td>
<td>2.24 km</td>
</tr>
<tr>
<td>Rio Branco</td>
<td>2.24 km</td>
</tr>
<tr>
<td>Pedra molhada</td>
<td>2.12 km</td>
</tr>
<tr>
<td>Lagoa doce</td>
<td>2.55 km</td>
</tr>
</tbody>
</table></figure>
<p>O ponto d’água mais próximo seria a <strong>Queda d’água</strong> com <strong>1.12km</strong> de distância</p>
</details>
</blockquote>
<p>É notável que essa tarefa não é muito eficiente. E, se saíssemos da mesma posição, precisaríamos calcular todas as distâncias novamente.</p>
<p>E se existisse um mapa que indique, para qualquer posição, qual a fonte d’água mais próxima?</p>
<h2>Subdivisão por células</h2>
<figure class="img"><img src="img/mapa4.jpg" alt="Duas fontes de água no mapa"></figure>
<p>Como podemos dividir esse espaço de modo a indicar, para qualquer ponto no mapa, qual a fonte mais próxima?</p>
<blockquote class="question">
<p>Pergunta</p>
<p>Pegue um papel e uma caneta e tente desenhar esse diagrama!</p>
<details class="answer">
<summary>Resposta</summary>
<p>Vamos traçar uma aresta que passa entre ambas as fontes e pintar de azul todos os pontos em que estão à esquerda dela e de verde aqueles que estão a sua direita:</p>
<figure class="img"><img src="img/mapa5.jpg" alt="Duas fontes de água no mapa"></figure>
<p>Agora, sabemos que, se você estiver em qualquer ponto azul, o ponto mais próximo é a <code class="language-Fonte">A</code>. Se você estiver em qualquer ponto verde, porém, o ponto mais próximo é a <code class="language-Fonte">B</code>.</p>
</details>
<p>Agora vamos tentar com três pontos:</p>
<figure class="img"><img src="img/mapa6.jpg" alt="Três fontes de água no mapa"></figure>

</blockquote>
<blockquote class="question">
<p>Pergunta</p>
<p>Pegue um papel e uma caneta e tente desenhar esse diagrama!</p>
<details class="answer">
<summary>Resposta</summary>
<p>Se traçarmos uma reta que divide cada um dos pontos d’água entre si, podemos criar três arestas que subdividem o espaço em três células distintas.</p>
<!-- Se ligarmos uma reta ligando dois pontos quaisquer e traçarmos outra reta perpendicular a ela que cruza o seu centro, conseguimos subdividir o espaço com três arestas. -->
<figure class="img"><img src="img/mapa7.jpg" alt="Duas fontes de água no mapa"></figure>
<p><strong>Observe atentamente esse diagrama e preste atenção nos detalhes:</strong></p>
<ul>
<li>
<p>O cruzamento de todos os segmentos de reta é no <strong>baricentro</strong> do triangulo formado pelas ligações entre os pontos.</p>
</li>
<li>
<p>O ângulo entre cada uma das arestas e as retas que ligam 2 pontos é de 90º.</p>
</li>
<li>
<p>Uma aresta sempre <strong>divide ao meio</strong> uma reta que liga dois pontos.</p>
</li>
</ul>
<p>Assim, é muito mais fácil ver qual o ponto d’água mais próximo para qualquer ponto do mapa!</p>
</details>
</blockquote>
<h2>Diagrama de Voronoi:</h2>
<p>Dividindo pontos com arestas dessa maneira, podemos criar um mapa que nos conta exatamente qual o ponto mais próximo! Esse é o princípio do <strong>Diagrama de Voronoi</strong>.</p>
<figure class="img"><img src="img/Coloured_Voronoi_2D.png" alt="Diagrama de Voronoi"></figure>
<p>Source: <a href="https://pt.wikipedia.org/wiki/Diagrama_de_Voronoy" target="_blank">Wikipédia</a></p>
<h2>O algoritmo de Fortune</h2>
<p>Uma das formas mais eficientes de gerar diagramas de Voronoi é com o algoritmo de Fortune. Para entender seu funcionamento, vamos partir de uma ideia diferente — mas calma, no fim tudo fará sentido.</p>
<p>Vamos começar com o exemplo abaixo:</p>
<blockquote class="question">
<p>Pergunta</p>
<p>Pegue um papel e caneta e desenhe um ponto pequeno (chamaremos de ponto1), com uma linha horizontal poucos centimetros abaixo e desenhe 5 pontos sobre essa linha (Facilita se voce colocar o ponto do meio exatamente embaixo do ponto1). Agora tente encontrar os pontos de equidistancia entre o ponto original e os pontos sobre a linha.</p>
<p>Vai ficar algo parecido com isso:</p>
<figure class="img"><img src="img/mapa8tr.jpg" alt="Ponto e Pontos na linha"></figure>
<p>Agora, tente encontrar os pontos equidistantes entre os pontos da linha e o ponto 1</p>
<details class="answer">
<summary>Resposta</summary>
<p>Seu diagrama deve ficar algo parecido com:</p>
<figure class="img"><img src="img/mapa9tr.jpg" alt="Pontos de equidistancia"></figure>
</details>
</blockquote>
<blockquote class="question">
<p>Pergunta</p>
<p>Você consegue perceber alguma relação entre esses pontos? Que formato esse padrão formaria?</p>
<details class="answer">
<summary>Resposta</summary>
<p>Voce deve ter concluido que os pontos de equidistancia formam uma parabola</p>
<figure class="img"><img src="img/mapa10tr.jpg" alt="Parabola"></figure>
</details>
</blockquote>
<p>Agora partimos para um segundo instante. Vamos imaginar que a sweeping line desceu um pouco, para um pouco mais longe do nosso ponto 1.</p>
<blockquote class="question">
<p>Pergunta</p>
<p>Tente pensar no que vai acontecer com os pontos e então com a parabola.</p>
<p>Sera que ela vai abrir/fechar mais? Sera que vai permanecer igual?</p>
<p>Se nao estiver conseguindo visualizar, use o papel e compare as respostas. Para que a diferença fique mais clara, faca uma sweeping line bem mais longe do ponto.</p>
<details class="answer">
<summary>Resposta</summary>
<p>A parabola vai abrir cada vez mais quando a sweeping line desce.</p>
<figure class="img"><img src="img/mapa11tr.jpg" alt="Parabola aberta"></figure>
</details>
</blockquote>
<p>Caso tenha restado alguma duvida, desenvolvemos um arquivo no geogebra que facilita muito o entendimento:</p>
<div style="position:relative; width:fit">
<iframe src="https://www.geogebra.org/calculator/xztbxdvv?embed" allowfullscreen="" style="border: 1px solid #e4e4e4;border-radius: 4px; width:100%; height:70vh" frameborder="0"></iframe>
</div>
<p>Agora nos deduzimos tudo o que deveriamos para um ponto so, e esta na hora de acrescentar um segundo ponto, ai mais pra frente um terceiro.</p>
<hr>
<p>Vamos começar evoluindo a atividade que fizemos para um ponto, agora usando 2. Cada um vai formar a sua parabola, que vai seguir o mesmo padrão da atividade que fizemos com um ponto so. Mas agora…</p>
<blockquote class="question">
<p>Pergunta</p>
<p>Vamos pensar agora sobre a interseção dessas parabolas.
Desenvolvemos um arquivo no GeoGebra que vai ajudar bastante a tirar essa conclusão. Tente encontrar o tipo de relação entre os pontos de interseção com a sweeping line variando.</p>
<p>Vai ser uma relação linear? Quadratica? Logaritmica?</p>
<div style="position:relative; width:fit">
<iframe src="https://www.geogebra.org/calculator/vkarzdzv?embed" allowfullscreen="" style="border: 1px solid #e4e4e4;border-radius: 4px; width:100%; height:70vh" frameborder="0"></iframe>
</div>
<details class="answer">
<summary>Resposta</summary>
<p>Para obter a resposta, ativar o trace do ponto de interseção.</p>
</details>
</blockquote>
<blockquote class="question">
<p>Pergunta</p>
<p>Sabendo isso, O que conseguimos deduzir sobre pontos que para um lado da linha e para o outro? O que todos tem em comum com quais respectivos pontos de interesse?</p>
<p>Dica: Pense na distancia</p>
<details class="answer">
<summary>Resposta</summary>
<p>Conseguimos concluir que pontos de cada lado da linha estao mais proximos do ponto de interesse que esta do mesmo lado da linha</p>
</details>
</blockquote>
<p>Parabens, voce acabou de entender a logica por traz de um algoritmo de Fortune para 2 pontos em um grafico!</p>
<hr>
<p>Antes de adicionar-mos um ponto, vamos entender o conceito da beachline.</p>
<p>Como no início do handout, pense nos pontos equidistantes entre um ponto e a sweeping line — eles formam uma parábola. Pensou? Agora imagine duas dessas parábolas. A beachline é formada pelos pontos que estão ao mesmo tempo nas duas parábolas e que estão mais próximos da sweeping line em cada posição no eixo x.</p>
<p>Aqui esta uma imagem que nos ajuda a visualizar isso.</p>
<p>Agora que entendemos o conceito, vamos adicionar um terceiro ponto. A lógica é a mesma para 4, 5 ou mais pontos, então, ao compreendermos o caso com 3, poderemos generalizar para qualquer quantidade.</p>
<p>Voltando a pensar nas parabolas criadas e nossa sweeping line, quais sao os pontos de equidistancia entre qualquer um dos pontos e a sweeping line? Perceba que esses pontos vao formar uma linha, e chamaremos essa linha de beachline
Dica: Pense nas parabolas e seus pontos de interseçoes.</p>
<p>Abaixo esta um arquivo no GeoGebra que facilita essa visualização e entendimento.</p>
<div style="position:relative; width:fit">
<iframe src="https://www.geogebra.org/calculator/nghuzruv?embed" allowfullscreen="" style="border: 1px solid #e4e4e4;border-radius: 4px; width:100%; height:70vh" frameborder="0"></iframe>
</div>
<h3>TRES PONTOS</h3>
<p>GUIZAO VAI ESCREVER AS ATIVIDADES PROS 3 PONTOS</p>
<div style="position:relative; width:fit">
<iframe src="https://www.geogebra.org/calculator/z9zcsu6s?embed" allowfullscreen="" style="border: 1px solid #e4e4e4;border-radius: 4px; width:100%; height:70vh" frameborder="0"></iframe>
</div>
<hr>
<h3>Complexidade</h3>
<p>O algoritmo de Fortune tem complexidade O(n log n). Isso quer dizer que, conforme o número de pontos aumenta, o tempo de execução cresce um pouco mais rápido que de forma linear.
A razão disso é que o algoritmo precisa processar os pontos em uma ordem específica, simulando a passagem da sweeping line. Cada vez que um novo evento acontece (por exemplo, quando a linha encontra um ponto ou quando duas parábolas se cruzam), o algoritmo atualiza o diagrama. O número total de atualizações é proporcional a n, já que há um evento principal para cada ponto. Essas atualizações não são instantâneas — elas exigem um pequeno custo adicional, que é o “log n” na conta.
Em resumo: ele é rápido porque analisa cada ponto apenas quando necessário e faz atualizações de forma organizada, sem precisar recalcular todo o diagrama a cada passo.</p>
<p>Outros algoritmos para gerar diagramas de Voronoi são menos eficientes que o de Fortune.
Um exemplo é o método direto por distância, que compara cada ponto do plano com todos os sítios e tem complexidade O(n²). Outro é o método incremental, que adiciona os pontos um a um e atualiza o diagrama a cada inserção, também com custo próximo de O(n²).
Por isso, o algoritmo de Fortune se destaca como o mais rápido entre eles, com complexidade O(n log n).</p>


        </main>
        <footer>
            <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">
                <img alt="CC BY-SA 4.0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" title="Creative Commons Attribution-ShareAlike 4.0 International License" />
            </a>
            © 2024 Marcelo Hashimoto
        </footer>
    </div>
</body>

</html>